# API для новостного портала
## Описание приложения
Возможности API:

- Для пользователей:
  - Регистрация пользователя с помощью адреса электронной почты
  - Аутентификация с помощью JSON Web Token
  - Получение списка новостей для авторизованных и неавторизованных пользователей
  - Получение комментариев новости для авторизованного пользователя
  - Возможность оставить комментарий к новости для авторизованного пользователя
  - Возможность оставить комментарий к любому комментарию новости для авторизованного пользователя (максимальный уровень вложенности комментариев - 5). При этом пользователю, на чей комментарий оставили комментарий, на email приходит соответствующее уведомление

- Для администратора:
  - Аутентификация с помощью JSON Web Token
  - Получение списка новостей
  - Создание новости
  - Редактирование новости
  - Удаление новости (при удалении новости удаляются все комментарии связанные с новостью)
  - Удаление комментария (при удалении комментария удаляются все его дочерние комментарии)
  - Возможность забанить пользователя. Забаненному пользователю запрещено оставлять любые комментарии. При бане пользователю приходит соответствующее email уведомление

## Стек технологий:
- Python 3
- Django
- СУБД PostgreSQL (через отдельный Docker-образ)
- Контейнер с приложением должен использовать alpine
- Описание API - Swagger OpenAPI Version 3

## Установка и запуск
Скачиваем проект
```sh
git clone https://github.com/BPIlyich/simbirsoft_spring2020test.git
```
Заполняем и переименовываем файл *.env.dev-sample* в *.env.dev*
Сборка и первоначальный запуск
```sh
docker-compose up --build
```
Создание пользователя с правами администратора. Команда работает аналогично `createsuperuser`
```sh
docker-compose run web python manage.py createuser --is-staff
```
Остановка приложения
```sh
docker-compose down
```

## Дальнейшие взаимодействия c приложением

Для регистрации пользователя делаем POST запрос на `http://127.0.0.1:8000/auth/users/` с параметрами
```json
{
  "username": "username",
  "email": "user@example.com",
  "password": "string"
}
```
Далее получаем токен с помощью POST запроса на `http://127.0.0.1:8000/auth/jwt/create/` c указанными до этого `email` и `password`
```json
{
  "email": "user@example.com",
  "password": "string"
}
```
В ответ получим токен, необходимый для дальнейшего взаимодействия с приложением
```json
{
    "refresh": "YOURTOKENREFRESH",
    "access": "YOURTOKEN"
}
```
Описание API доступно по адресу `http://127.0.0.1:8000/api/schema/swagger-ui/`